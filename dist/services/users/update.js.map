{"version":3,"sources":["../../../src/services/users/update.ts"],"sourcesContent":["import { IUser, User } from '@/models/User'\n\nimport { error } from 'elysia'\n\nexport const updateUserService = async (id: string, { email, password }: IUser) => {\n  const user = await User.findById(id)\n\n  if (!user) {\n    throw error('Not Found', { error: 'Usuário não encontrado' })\n  }\n\n  if (email) {\n    const existingUser = await User.findOne({ email })\n\n    const isDifferentUser = existingUser?.id !== id\n\n    if (isDifferentUser) {\n      throw error('Conflict', { error: 'Esse e-mail já está em uso' })\n    }\n\n    user.email = email\n  }\n\n  if (password) {\n    user.password = password\n  }\n\n  await user?.save().catch(() => {\n    throw error('Internal Server Error', { error: 'Falha ao atualizar usuário' })\n  })\n\n  return user\n}\n"],"names":["updateUserService","id","email","password","user","User","findById","error","existingUser","findOne","isDifferentUser","save","catch"],"mappings":";;;;+BAIaA;;;eAAAA;;;sBAJe;wBAEN;AAEf,MAAMA,oBAAoB,OAAOC,IAAY,EAAEC,KAAK,EAAEC,QAAQ,EAAS;IAC5E,MAAMC,OAAO,MAAMC,UAAI,CAACC,QAAQ,CAACL;IAEjC,IAAI,CAACG,MAAM;QACT,MAAMG,IAAAA,aAAK,EAAC,aAAa;YAAEA,OAAO;QAAyB;IAC7D;IAEA,IAAIL,OAAO;QACT,MAAMM,eAAe,MAAMH,UAAI,CAACI,OAAO,CAAC;YAAEP;QAAM;QAEhD,MAAMQ,kBAAkBF,cAAcP,OAAOA;QAE7C,IAAIS,iBAAiB;YACnB,MAAMH,IAAAA,aAAK,EAAC,YAAY;gBAAEA,OAAO;YAA6B;QAChE;QAEAH,KAAKF,KAAK,GAAGA;IACf;IAEA,IAAIC,UAAU;QACZC,KAAKD,QAAQ,GAAGA;IAClB;IAEA,MAAMC,MAAMO,OAAOC,MAAM;QACvB,MAAML,IAAAA,aAAK,EAAC,yBAAyB;YAAEA,OAAO;QAA6B;IAC7E;IAEA,OAAOH;AACT"}